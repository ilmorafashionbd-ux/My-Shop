<!doctype html>

<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Shop ‚Äì Google Sheets Connected</title>
  <meta name="description" content="Professional, mobile‚Äëfirst e‚Äëcommerce front‚Äëend that pulls products from Google Sheets JSON (gviz). Host free on GitHub Pages.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0f172a;--panel:#0b1220;--card:#0c1628;--muted:#94a3b8;--text:#e5eef7;--brand:#22c55e;--accent:#38bdf8;--line:#1f2937;--warn:#fde68a;--danger:#ef4444}
    *{box-sizing:border-box}
    body{margin:0;font-family:"Noto Sans Bengali",system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0b1220,#0f172a 30%,#0b1220);color:var(--text)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:16px}
    header{position:sticky;top:0;z-index:30;background:rgba(15,23,42,.85);backdrop-filter:blur(10px);border-bottom:1px solid var(--line)}
    .brand{display:flex;gap:10px;align-items:center;font-weight:800}
    .logo{width:38px;height:38px;border-radius:12px;background:radial-gradient(circle at 30% 30%,var(--brand),#16a34a);box-shadow:0 0 0 3px rgba(34,197,94,.16);overflow:hidden}
    .logo img{width:100%;height:100%;object-fit:cover;display:block}
    .toolbar{display:grid;grid-template-columns:1fr 180px 180px auto;gap:10px}
    input,select,button{border-radius:12px;border:1px solid var(--line);background:var(--panel);color:var(--text);padding:10px 12px}
    input::placeholder{color:#6b7280}
    button{cursor:pointer}
    .btn.primary{background:linear-gradient(135deg,var(--brand),#16a34a);border:none;color:#052e14;font-weight:700}
    .btn.ghost{background:transparent;border-color:#334155}
    .grid{display:grid;gap:12px;grid-template-columns:repeat(2,1fr)}
    @media(min-width:768px){.grid{grid-template-columns:repeat(3,1fr)} .toolbar{grid-template-columns:1fr 200px 200px auto}}
    @media(min-width:1024px){.grid{grid-template-columns:repeat(4,1fr)}}
    .card{border:1px solid var(--line);border-radius:16px;overflow:hidden;background:linear-gradient(180deg,var(--panel) 0%,var(--card) 100%);box-shadow:0 10px 30px rgba(2,6,23,.35)}
    .card img{width:100%;aspect-ratio:1/1;object-fit:cover;display:block}
    .content{padding:10px 12px}
    .row{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .price{color:#a7f3d0;font-weight:800}
    .muted{color:var(--muted);font-size:.9rem}
    .tag{font-size:.72rem;padding:3px 8px;border-radius:999px;background:#07101f;border:1px solid #334155;color:#bae6fd}
    .notice{margin:12px 0;padding:10px 12px;border:1px solid #334155;border-radius:12px;background:#0b1220;color:#cbd5e1}/* HERO BANNER */
.hero{position:relative;overflow:hidden;border-bottom:1px solid var(--line)}
.slides{display:grid;grid-auto-flow:column;grid-auto-columns:100%;scroll-snap-type:x mandatory;overflow:auto;scroll-behavior:smooth}
.slides::-webkit-scrollbar{display:none}
.slide{position:relative;height:200px;scroll-snap-align:start}
.slide img{width:100%;height:100%;object-fit:cover;display:block}
.hero-dots{position:absolute;left:0;right:0;bottom:10px;display:flex;gap:6px;justify-content:center}
.dot{width:8px;height:8px;border-radius:999px;background:#334155;border:1px solid #475569}
.dot.active{background:#e2e8f0}
@media(min-width:768px){.slide{height:320px}}

/* Cart */
.cart-fab{position:fixed;right:16px;bottom:16px;z-index:40}
.panel{position:fixed;inset:0 0 0 auto;width:92%;max-width:430px;background:var(--panel);border-left:1px solid var(--line);transform:translateX(100%);transition:transform .25s ease;display:flex;flex-direction:column;z-index:50}
.panel.open{transform:translateX(0)}
.panel-h{padding:14px 16px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
.panel-b{padding:12px;border-top:1px solid var(--line);display:grid;gap:10px}
.items{flex:1;overflow:auto;padding:12px;display:grid;gap:10px}
.item{display:grid;grid-template-columns:64px 1fr auto;gap:10px;align-items:center;border:1px solid var(--line);border-radius:12px;padding:8px}
.item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
.qty{display:inline-flex;align-items:center;border:1px solid #334155;border-radius:10px;overflow:hidden}
.qty button{background:transparent;border:none;color:var(--text);padding:6px 10px}
.qty span{min-width:28px;text-align:center}
footer{padding:30px 16px;color:#94a3b8;text-align:center}
.skeleton{background:linear-gradient(90deg,#0b1220 25%,#0d1628 37%,#0b1220 63%);background-size:400% 100%;animation:shimmer 1.4s ease infinite}
@keyframes shimmer{0%{background-position:100% 0}100%{background-position:-100% 0}}

  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;align-items:center;gap:12px;justify-content:space-between;padding:10px 0;">
      <div class="brand">
        <span class="logo"><img id="brandLogo" alt="Logo"></span>
        <span id="brandName">My Shop</span>
      </div>
      <div class="toolbar">
        <input id="q" placeholder="‡¶∏‡¶æ‡¶∞‡ßç‡¶ö‚Ä¶ (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ü‡¶ø‚Äë‡¶∂‡¶æ‡¶∞‡ßç‡¶ü, ‡¶≤‡¶ø‡¶™‡¶∏‡ßç‡¶ü‡¶ø‡¶ï)">
        <select id="cat"><option value="all">‡¶∏‡¶¨ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø</option></select>
        <select id="sort">
          <option value="recent">‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶ó‡ßá</option>
          <option value="price-asc">‡¶¶‡¶æ‡¶Æ: ‡¶ï‡¶Æ ‚Üí ‡¶¨‡ßá‡¶∂‡¶ø</option>
          <option value="price-desc">‡¶¶‡¶æ‡¶Æ: ‡¶¨‡ßá‡¶∂‡¶ø ‚Üí ‡¶ï‡¶Æ</option>
        </select>
        <button class="btn ghost" id="openCart">üõí ‡¶ï‡¶æ‡¶∞‡ßç‡¶ü (<span id="cc1">0</span>)</button>
      </div>
    </div>
  </header>  <!-- HERO BANNERS -->  <section class="hero">
    <div class="slides" id="slides"></div>
    <div class="hero-dots" id="dots"></div>
  </section>  <div class="container">
    <div class="notice" id="status">üì¶ Google Sheets ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá‚Ä¶</div>
    <div id="grid" class="grid"></div>
  </div><button class="btn primary cart-fab" id="fab">üõí ‡¶ï‡¶æ‡¶∞‡ßç‡¶ü ‚Ä¢ <span id="cc2">0</span></button>

  <aside class="panel" id="cart">
    <div class="panel-h"><strong>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡ßç‡¶ü</strong><button class="btn ghost" id="closeCart">‚úï</button></div>
    <div class="items" id="items"></div>
    <div class="panel-b">
      <div class="row"><span style="font-weight:700">‡¶∏‡¶æ‡¶¨‡¶ü‡ßã‡¶ü‡¶æ‡¶≤</span><span id="total">‡ß≥0</span></div>
      <button class="btn primary" id="checkout">‚úÖ WhatsApp‚Äë‡¶è ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <small class="muted">‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Ö‡¶® ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø/‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü‚ÄîWhatsApp‚Äë‡¶è ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</small>
    </div>
  </aside>  <footer>¬© <span id="yr"></span> <span id="footerBrand">My Shop</span> ¬∑ GitHub Pages</footer><script>
/****************** CONFIG (‡¶è‡¶ñ‡¶æ‡¶®‡¶ü‡¶æ‡¶á ‡¶¨‡¶¶‡¶≤‡¶æ‡¶¨‡ßá‡¶®) ******************/
// 1) Google Sheets gviz JSON ‡¶≤‡¶ø‡¶Ç‡¶ï
const DATA_URL = "https://docs.google.com/spreadsheets/d/1Euf6Rz-fRAjtzVj7aEoxmzxLA7vrfOuAvNjfo-ctDf0/gviz/tq?tqx=out:json";

// 2) WhatsApp ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ (‡¶¶‡ßá‡¶∂ ‡¶ï‡ßã‡¶°‡¶∏‡¶π, + ‡¶õ‡¶æ‡ßú‡¶æ)
const WHATSAPP = "8801778095805";

// 3) ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° ‡¶ï‡¶®‡¶´‡¶ø‡¶ó: ‡¶®‡¶æ‡¶Æ, ‡¶≤‡ßã‡¶ó‡ßã, ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡¶ø (‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠/‡¶á‡¶Æ‡¶ó‡ßÅ‡¶∞/‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®)
const BRAND = {
  name: "ILMORA Fashion BD",
  logo: "https://drive.google.com/uc?id=1iItMRsMxcLkKaDQnWVw1ELR9Hpzaex6F", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ó‡ßã ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï
  banners: [
    // ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶™‡ßç‡¶∞‡¶•‡¶Æ 5‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá)
    "https://drive.google.com/uc?id=1iItMRsMxcLkKaDQnWVw1ELR9Hpzaex6F",
    "https://i.ibb.co/2n2PpYj/sample2.jpg"
  ]
};

// 4) ‡¶∂‡¶ø‡¶ü‡ßá‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶π‡ßá‡¶°‡¶æ‡¶∞ (‡¶ï‡ßá‡¶∏-‡¶á‡¶®‡¶∏‡ßá‡¶®‡¶∏‡¶ø‡¶ü‡¶ø‡¶≠)
const HEADERS = {
  name: ["name","product","product name","‡¶™‡¶£‡ßç‡¶Ø","‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ"],
  price: ["price","‡¶¶‡¶æ‡¶Æ","‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø"],
  description: ["description","‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ","details","‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§"],
  image: ["image","photo","img","‡¶õ‡¶¨‡¶ø"],
  category: ["category","‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø","‡¶ß‡¶∞‡¶£"],
  sku: ["sku","code","‡¶™‡¶£‡ßç‡¶Ø ‡¶ï‡ßã‡¶°"],
  badge: ["badge","tag","‡¶≤‡ßá‡¶¨‡ßá‡¶≤"],
  stock: ["stock","stok","‡¶∏‡ßç‡¶ü‡¶ï"]
};

/****************** STATE ******************/
const els = {
  grid: document.getElementById('grid'),
  q: document.getElementById('q'),
  cat: document.getElementById('cat'),
  sort: document.getElementById('sort'),
  status: document.getElementById('status'),
  cc1: document.getElementById('cc1'),
  cc2: document.getElementById('cc2'),
  cart: document.getElementById('cart'),
  items: document.getElementById('items'),
  total: document.getElementById('total'),
  openCart: document.getElementById('openCart'),
  closeCart: document.getElementById('closeCart'),
  fab: document.getElementById('fab'),
  slides: document.getElementById('slides'),
  dots: document.getElementById('dots'),
  brandLogo: document.getElementById('brandLogo'),
  brandName: document.getElementById('brandName'),
  footerBrand: document.getElementById('footerBrand')
};

let PRODUCTS = []; // {id,title,price,img,cat,desc,sku,badge,createdAt}
let STATE = {q:'',cat:'all',sort:'recent',cart:[]};

/****************** UTILS ******************/
const fmt = n => '‡ß≥'+(+n||0).toLocaleString('bn-BD');
const safe = s => (s==null? '' : String(s));
const by = (a,b,k)=> (a[k]||'').toString().localeCompare((b[k]||'').toString(), 'bn');

function setStatus(msg, ok=true){
  els.status.textContent = msg;
  els.status.style.background = ok? '#0b1220' : '#3b0a0a';
}

// ‚úÖ Google Drive ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶æ‡¶∞ (id=... / file/d/... ‡¶¶‡ßÅ‡¶á ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá‡¶á ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá)
function fixGoogleDriveLink(url){
  if(!url) return '';
  if(url.includes('drive.google.com')){
    let idMatch = url.match(/[?&]id=([^&]+)/);
    if(!idMatch){
      const m2 = url.match(/\/d\/([\w-]+)/); // file/d/FILEID/view
      if(m2) idMatch = [, m2[1]];
    }
    const fileId = idMatch? idMatch[1] : null;
    if(fileId) return `https://drive.google.com/uc?id=${fileId}`;
  }
  return url;
}

// ‡¶á‡¶Æ‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶´‡ßá‡¶≤ ‡¶π‡¶≤‡ßá ‡¶™‡ßç‡¶≤‡ßá‡¶∏‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞
function withFallback(imgEl){
  imgEl.onerror = ()=>{ imgEl.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="600" height="600"><rect width="100%" height="100%" fill="%230b1220"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="%2394a3b8" font-family="sans-serif" font-size="18">Image not available</text></svg>'; };
}

/****************** FETCH & PARSE (GVIZ) ******************/
async function loadFromGviz(){
  const res = await fetch(DATA_URL, {cache:'no-store'});
  const text = await res.text();
  const json = JSON.parse(text.substring(text.indexOf('(')+1, text.lastIndexOf(')')));
  const table = json.table;
  const rows = table.rows || [];
  if(!rows.length){ throw new Error('‡¶∂‡¶ø‡¶ü‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á'); }

  const headerRow = rows[0].c.map(c=> (c? String(c.v).trim().toLowerCase(): ''));
  const map = {};
  Object.entries(HEADERS).forEach(([key, aliases])=>{
    const idx = headerRow.findIndex(h=> aliases.includes(h));
    if(idx>-1) map[key]=idx;
  });

  const noHeader = Object.keys(map).length<2;
  let startIndex = 1;
  if(noHeader){
    startIndex = 0;
    table.cols.forEach((col,i)=>{ map[Object.keys(HEADERS)[i]] = i; });
  }

  const list = [];
  for(let r=startIndex; r<rows.length; r++){
    const c = rows[r].c || [];
    const name = safe(c[map.name]?.v);
    const price = safe(c[map.price]?.v);
    const image = safe(c[map.image]?.v);
    if(!name || !price || !image) continue;
    list.push({
      id: r,
      title: name,
      price: +price,
      img: fixGoogleDriveLink(image),
      desc: safe(c[map.description]?.v),
      cat: safe(c[map.category]?.v)||'‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø',
      sku: safe(c[map.sku]?.v),
      badge: safe(c[map.badge]?.v),
      stock: safe(c[map.stock]?.v),
      createdAt: Date.now()-r*100000
    });
  }
  return list;
}

/****************** HERO (LOGO & BANNERS) ******************/
function renderBrand(){
  els.brandName.textContent = BRAND.name || 'My Shop';
  els.footerBrand.textContent = BRAND.name || 'My Shop';
  const lg = fixGoogleDriveLink(BRAND.logo||'');
  els.brandLogo.src = lg || 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80"><rect width="100%" height="100%" rx="16" fill="%2322c55e"/></svg>';
  withFallback(els.brandLogo);

  const banners = (BRAND.banners||[]).slice(0,5).map(fixGoogleDriveLink);
  els.slides.innerHTML = banners.map((b,i)=>`<div class="slide"><img src="${b}" alt="Banner ${i+1}" loading="lazy"></div>`).join('');
  els.dots.innerHTML = banners.map((_,i)=>`<span class="dot ${i===0?'active':''}"></span>`).join('');

  // Auto slide
  let idx=0; const sc = els.slides;
  setInterval(()=>{
    idx = (idx+1)%banners.length; sc.scrollTo({left: idx*sc.clientWidth, behavior:'smooth'});
    [...els.dots.children].forEach((d,j)=> d.classList.toggle('active', j===idx));
  }, 3500);
}

/****************** RENDER ******************/
function renderCats(){
  const cats = ['all', ...new Set(PRODUCTS.map(p=>p.cat))];
  els.cat.innerHTML = cats.map(c=>`<option value="${c}">${c==='all'?'‡¶∏‡¶¨ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø':c}</option>`).join('');
}

function render(){
  let list = PRODUCTS.filter(p=> (STATE.cat==='all'||p.cat===STATE.cat) &&
                                 (STATE.q===''|| p.title.toLowerCase().includes(STATE.q) || p.desc.toLowerCase().includes(STATE.q)));
  if(STATE.sort==='price-asc') list.sort((a,b)=>a.price-b.price);
  else if(STATE.sort==='price-desc') list.sort((a,b)=>b.price-a.price);
  else list.sort((a,b)=>b.createdAt-a.createdAt);

  els.grid.innerHTML = list.map(p=>`
    <div class="card">
      <img loading="lazy" src="${p.img}" alt="${p.title}" onerror="this.onerror=null;this.src='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"600\" height=\"600\"><rect width=\"100%\" height=\"100%\" fill=\"%230b1220\"/><text x=\"50%\" y=\"50%\" dominant-baseline=\"middle\" text-anchor=\"middle\" fill=\"%2394a3b8\" font-family=\"sans-serif\" font-size=\"18\">Image not available</text></svg>'">
      <div class="content">
        <div class="row"><strong>${p.title}</strong>${p.badge?`<span class="tag">${p.badge}</span>`:''}</div>
        <div class="muted" style="margin-top:4px">${p.desc||''}</div>
        <div class="row" style="margin-top:8px"><span class="price">${fmt(p.price)}</span>
          <button class="btn primary" onclick="add(${p.id})">‚ûï ‡¶ï‡¶æ‡¶∞‡ßç‡¶ü‡ßá ‡¶®‡¶ø‡¶®</button></div>
        <div class="muted" style="margin-top:6px">‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø: ${p.cat}${p.sku?` ‚Ä¢ ‡¶ï‡ßã‡¶°: ${p.sku}`:''}${p.stock?` ‚Ä¢ ‡¶∏‡ßç‡¶ü‡¶ï: ${p.stock}`:''}</div>
      </div>
    </div>`).join('');
}

/****************** CART ******************/
function add(id){
  const prod = PRODUCTS.find(p=>p.id===id);
  const ex = STATE.cart.find(i=>i.id===id);
  if(ex) ex.qty++; else STATE.cart.push({id:prod.id,title:prod.title,price:prod.price,img:prod.img,qty:1});
  syncCart();
}
function qty(id,d){
  const it = STATE.cart.find(i=>i.id===id); if(!it) return; it.qty+=d; if(it.qty<=0) STATE.cart=STATE.cart.filter(i=>i.id!==id); syncCart();
}
function syncCart(){
  const count = STATE.cart.reduce((s,i)=>s+i.qty,0); els.cc1.textContent=count; els.cc2.textContent=count;
  const total = STATE.cart.reduce((s,i)=>s+i.qty*i.price,0); els.total.textContent = fmt(total);
  els.items.innerHTML = STATE.cart.map(i=>`
    <div class="item">
      <img loading="lazy" src="${i.img}" alt="${i.title}" onerror="this.onerror=null;this.src='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"64\" height=\"64\"><rect width=\"100%\" height=\"100%\" fill=\"%230b1220\"/></svg>'">
      <div><div style="font-weight:700">${i.title}</div><div class="muted">${fmt(i.price)} √ó ${i.qty}</div></div>
      <div class="qty"><button onclick="qty(${i.id},-1)">‚àí</button><span>${i.qty}</span><button onclick="qty(${i.id},1)">+</button></div>
    </div>`).join('');
}
function toggleCart(open){ els.cart.classList[open?'add':'remove']('open'); }
function checkout(){
  if(!STATE.cart.length) { alert('‡¶ï‡¶æ‡¶∞‡ßç‡¶ü ‡¶ñ‡¶æ‡¶≤‡¶ø!'); return; }
  const lines = STATE.cart.map(i=>`‚Ä¢ ${i.title} x${i.qty} = ‡ß≥${i.price*i.qty}`).join('%0A');
  const total = STATE.cart.reduce((s,i)=>s+i.qty*i.price,0);
  const msg = `‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶á:%0A${lines}%0A‡¶Æ‡ßã‡¶ü: ‡ß≥${total}%0A‡¶®‡¶æ‡¶Æ:%0A‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ:%0A‡¶´‡ßã‡¶®:`;
  window.open(`https://wa.me/${WHATSAPP}?text=${msg}`,'_blank');
}

/****************** INIT ******************/
(async function(){
  document.getElementById('yr').textContent = new Date().getFullYear();
  renderBrand();
  // Skeleton cards
  els.grid.innerHTML = Array.from({length:8}).map(()=>`<div class='card'><div class='skeleton' style='width:100%;aspect-ratio:1/1;border-bottom:1px solid var(--line)'></div><div class='content'><div class='skeleton' style='height:18px;border-radius:8px'></div><div class='skeleton' style='height:12px;margin-top:8px;border-radius:8px'></div><div class='skeleton' style='height:36px;margin-top:10px;border-radius:10px'></div></div></div>`).join('');
  try{
    PRODUCTS = await loadFromGviz();
    if(!PRODUCTS.length) setStatus('‚ö†Ô∏è ‡¶∂‡¶ø‡¶ü‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø', false);
    else setStatus('‚úÖ Google Sheets ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶°! ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§');
    renderCats();
    render();
  }catch(err){
    console.error(err);
    setStatus('‚ùå ‡¶≤‡ßã‡¶° ‡¶π‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: '+err.message, false);
    els.grid.innerHTML = '';
  }
})();

// Events
els.q.addEventListener('input', e=>{ STATE.q = e.target.value.trim().toLowerCase(); render(); });
els.cat.addEventListener('change', e=>{ STATE.cat = e.target.value; render(); });
els.sort.addEventListener('change', e=>{ STATE.sort = e.target.value; render(); });
els.openCart.addEventListener('click', ()=>toggleCart(true));
els.fab.addEventListener('click', ()=>toggleCart(true));
els.closeCart.addEventListener('click', ()=>toggleCart(false));
</script></body>
</html>